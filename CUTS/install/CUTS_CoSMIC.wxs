<?xml version='1.0' encoding='utf-8' ?>

<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>
  <Product Name="CUTS Modeling Tools for CoSMIC"
           Id="9A601859-E2D1-4C1F-B897-B13fEA0261B0"
           UpgradeCode="1CEF4517-4472-4A6F-8D4E-4D5B5F3B240A"
           Language="1033" Codepage="1252" Version="0.2.1"
           Manufacturer="DOC Group, ISIS, Vanderbilt University">

    <Package Id="????????-????-????-????-????????????"
             Keywords='Installer'
             Description='CUTS Modeling Tools for CoSMIC'
             Manufacturer='DOC Group, ISIS, Vanderbilt University'
             InstallerVersion='200' Languages='1033' Compressed='yes'
             SummaryCodepage='1252' />

    <!-- Wix variables -->
    <WixVariable Id="WixUILicenseRtf" Value="$(env.CUTS_ROOT)\docs\License.rtf" />
    <WixVariable Id="WixUIBannerBmp"  Value="images\bannrbmp.bmp" />
    <WixVariable Id="WixUIDialogBmp"  Value="images\dlgbmp.bmp" />

<!--
    <Property Id="COSMIC_INSTALLED">
      <RegistrySearch Id="PICML.version" Root="HKCU" Type="raw"
                      Key="SOFTWARE\GME\Paradigms\PICML" Name="CurrentVersion" />
    </Property>

    <Condition Message='CUTS modeling tools requires CoSMIC to be installed first'>
      COSMIC_INSTALLED</Condition>
-->

    <!-- installation media -->
    <Media Id="1" Cabinet="CUTS_CoSMIC.cab" EmbedCab="yes" />

    <Directory Id='TARGETDIR' Name='SourceDir'>
      <Directory Id="SystemFolder" />

      <Directory Id="ProgramFilesFolder" Name="PFiles">
        <Directory Id="ISIS" Name="ISIS">
          <Directory Id="INSTALLDIR" Name="CUTS">
            <Component Id="CUTS" Guid="59C094F3-00A7-401d-864F-BB4F73448DAD">
              <!-- registry information for the application -->
              <RegistryKey Root="HKLM" Key="SOFTWARE\CUTS"
                            Action="createAndRemoveOnUninstall">
                <RegistryValue Type="string" Value="[INSTALLDIR]" Action="write" />
              </RegistryKey>
            </Component>

            <Directory Id="bin" Name="bin" />
            <Directory Id="etc" Name="etc">
              <Directory Id="schemas" Name="schemas" />
            </Directory>
          </Directory>
        </Directory>
      </Directory>
    </Directory>

    <!-- product features -->
    <Feature Id="CUTS_CoSMIC_feature" Title="CUTS Modeling Tools"
             Display="collapse" Absent="disallow"
             Description="Installs the default CUTS modeling tools for CoSMIC"
             Level="1" ConfigurableDirectory="INSTALLDIR"
             AllowAdvertise="no">

      <!-- gather all the CUTS related components -->
      <ComponentRef Id="CUTS" />

      <FeatureGroupRef Id="CUTS_CoSMIC.features.all"/>

      <!-- include the VC merge modules -->
      <FeatureRef Id="vc_merge_modules" />
    </Feature>

    <!-- user interface -->
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR" />

    <UIRef Id="WixUI_Mondo" />
    <UIRef Id="WixUI_ErrorProgressText" />
  </Product>
</Wix>
