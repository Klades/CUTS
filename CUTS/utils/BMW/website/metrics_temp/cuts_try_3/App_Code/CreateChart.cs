using System;
using System.Data;
using System.Configuration;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.IO;
using System.Xml;
using System.Text;


/// <summary>
/// Summary description for CreateChart
/// </summary>
/// 

namespace CreateCharts
{
    public class Chart
    {
        private DataTable dt;
        private string type;

        public Chart(DataTable dt)
        {
            this.dt = dt;
        }

        public Chart(DataTable dt, string type)
        {
            this.dt = dt;
            this.type = type;
        }

        public void generate()
        {
            switch (type)
            {
                case "many":
                    //writeXMLmany();
                    string five = "hi";
                    break;
                case "one":
                    writeXMLone();
                    break;
                default:
                    writeXMLone();
                    break;
            }
  
        }

        private void writeXMLone()
        {
            string path = @"../../xml/autogenerated.xml";
            FileInfo XMLExists = new FileInfo(path);
            if (XMLExists.Exists)
            {
                File.Delete(path);
            }
            
            
            XmlTextWriter writer = new XmlTextWriter( path , Encoding.UTF8);

            writer.WriteStartDocument();
            writer.WriteStartElement("chart"); // <chart>
            writer.WriteStartElement("chart_data"); // <chart_data>
            writer.WriteStartElement("row");   // <row>
            writer.WriteRaw("<null/>");        // <null/>
            writer.WriteElementString("string", "2001");
            writer.WriteElementString("string", "2002");
            writer.WriteElementString("string", "2003");
            writer.WriteElementString("string", "2005");
            writer.WriteEndElement();           // </row>


            writer.WriteStartElement("row");   // <row>
            writer.WriteElementString("string", "Region A");
            writer.WriteElementString("number", "5");
            writer.WriteElementString("number", "10");
            writer.WriteElementString("number", "30");
            writer.WriteElementString("number", "50");
            writer.WriteEndElement();           // </row>

            writer.WriteStartElement("row");   // <row>
            writer.WriteElementString("string", "Region B");
            writer.WriteElementString("number", "5");
            writer.WriteElementString("number", "10");
            writer.WriteElementString("number", "30");
            writer.WriteElementString("number", "50");
            writer.WriteEndElement();           // </row>


            writer.WriteStartElement("row");   // <row>
            writer.WriteElementString("string", "Region C");
            writer.WriteElementString("number", "5");
            writer.WriteElementString("number", "10");
            writer.WriteElementString("number", "30");
            writer.WriteElementString("number", "50");
            writer.WriteEndElement();           // </row>     

            writer.WriteEndElement();  // </chart_data>
            writer.WriteEndElement();  // </chart>
            writer.WriteEndDocument();
            writer.Flush();
            writer.Close();
         }
            
            
             

    }
}